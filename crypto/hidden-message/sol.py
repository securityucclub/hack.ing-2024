from Crypto.Util.number import long_to_bytes
import libnum

c1 = 0x21AC5606F2ACD2221EAE67710A73286D390F2AD99C33F6D31C2CDEED66554C7242078D314D5846822226D09C7FC8BD15ED5CEA5297DF7A513A7B267F6D2C6E1B7670367F1E695CA1BCF9E4FB876BEF3C4DE87BB60B997A96B40082D38F80328D51FA65D66F0BE7C42FAAC500C73F9FF4972ADD32CB7322BEE9AD4DFF4A1C35A9
c2 = 0x3ED5DFEAFD009D622DC7FDBFF8C99D730CE0DEC896C2E4A10B0E08C2D7D88516B8F37F41674D3C49C473C479E37DF96DEB320FA8DCBEC1ECD38924B1206F0A0020855F9E22A945C7579087886B93C6BE0E2349CC0ED204D268C78188A9D332E9CFFF077F5B87F3D7FA142ABC958916D489279B1049F845A889398299B992C9F3
c3 = 0x297143BE78EE5EB0CE590FF5911EB3DE9A180F80408D28DB4088CED09C033E39F47D5CD09C82A4C2F46BFE1B4E60AFE179CAF5D7B873CB63E2ED7FF7F2E21B952D0F5188FB21AC67D2D99414AA15BE3EF2D3C9AE1A048135522D14BC5A04B221E5898A9BD116DB9CF42F293302D8D3767B02255E46D01AD3DF2C8DE72175BEE4
c4 = 0x21812BD96D41BA84DD195ADDF97E5684336919DDF2A8C8946A664ECD220F69988DDC1FB07D06704F7897942EA9214A6617570601014B165BBDE338136B06975BA80F85A87D263566B029F22C369FC3625B153FD1C359CCD427D9F7F80763140BC1FB1418CBD425DAD3DF9551A8B5CB7580BB853E52B1CA77E7F3AAAAA5B2A260
c5 = 0xBD589AB23447DC2A83C9FA0D1325E5257BF1C096713FDABF7AC7ADF0951458E41B5E42C54D6E9639C6F10ADB2B813BA8427EB949EA9F649E7F06309A546FBB191FE0D485E471E52EF6DA570E4E42C9F03C6C56A95E53F8A592D1E18CF3982ABD2C62359392EC8ACEF3AF8FDD9BFA0F4F71377148CFAC7CD54C75DEDD7136705

n1 = 0x8E131BC246E9BD11D64153FDAA307B00F30654CF4130D80594400D74F66E1F892C899CB5021DA69B1668906B3667E3512395F5D88D671541B48BC91AE11AA00C72426B65B8DDA9654BD6DEB24A926EEDFEB108D1895E239E701D6A8B523A25F566C1FE87F16AC8D3EA50C20B8965578445074EBB3BF1AE5D77696507E6607C35
n2 = 0x8B5A3ED123854289085A4758D521DA1DDB44BC8EC70583F5745E9159B83DF92BA94E825F28676B14E19B58562AE02CEF26503EC5904E6180B8C8A962E8163D6E452895FFC89EAFFEAE0DAB953D17395B0EBB783A1B35242B0883C5236089D014336CC694F1898B4EE51933A48C0051FA45BF0ABC7C81F0CB7E1AFE55297C8F53
n3 = 0x8334A46BDA572A40876ECAD9D209793B120F7C19738179422E9D5BCAE35870461D77563673C2B6047C5E7028D03BC7BDE50C87A228F033459261C73E25769012AFCBCA9FD4D931481E69278104824671A1F0BC53A60B707570AD8B21235822ED1D379781F41AD81A1C991369AB6A9593920B8BE16C2DE9B49C227AEA39649E61
n4 = 0x5C0EEAF1238DFEA2D9500CDF8C9C1A15B56135580B3E36FD6DB0CC6A8C735A3DB0A09438B9D0F445CE90C9994BE21DD6DCD708FC641E9B11022A89187C881B82729AB19718987C734665060BB9587243791922BDD03E9C41072F11D393234AC3B1F13EB14C194DC66E958FAF2E14169B3E5608478DE69F6BCE3B0F5E9ED0E78F
n5 = 0xA890E4446B561B1FC1DBFF981AF45409F6CAD8689A14318D91E6DDCA617F6F505192E9B54E6D443E06D255CE8FB4D919CF4B86A3D284F1F8FCB3409B6942B5110E8F082AE75FF4A2E8449BB7B97F68FB0AE8746AABE2AA1A33DA061462D9A9D51E0AB4DB4E9CBE23383F51AF8C4A00D9BD1BB35F3395AB7B78A24777060A73F9


e=5


mod=[n1,n2,n3,n4,n5]
rem=[c1,c2,c3,c4,c5]

res=libnum.solve_crt(rem,mod)

print("\nAnswer:")

print(f"\nWe can solve M^e with CRT to get {res}")
val=libnum.nroot(res,5)
print(f"\nWith e=5, we take the fifth root to get: {val}")
print("Next we convert this integer to bytes, and display as a string.")
print(f"\nDecipher: {long_to_bytes(val)}")
