# Nombre: `malware`
### Dificultad: `Medium (ğŸƒğŸƒğŸƒğŸƒ)`
### CategorÃ­a: `misc`
### Autor: vicevalds
### Flag: `hack.ing{Th1s_1s_n0t_4_r3mc0sRAT}`

### DescripciÃ³n:
!! Oportunidad de ColaboraciÃ³n: Â¡Gana Dinero Promocionando Nuestra Tienda de Claves de Juegos! Â¡Â¡

Estimado,
Nos gustarÃ­a ofrecerte la oportunidad de asociarte con nosotros como promotor/a de nuestra tienda en lÃ­nea. En esencia, te estarÃ­amos ofreciendo una compensaciÃ³n financiera a cambio de tu promociÃ³n activa de nuestros productos.
Para obtener mÃ¡s detalles sobre esta emocionante oportunidad de colaboraciÃ³n y conocer los tÃ©rminos especÃ­ficos de compensaciÃ³n, te adjunto un archivo PDF que contiene un plan detallado.
Â¡No dudes en contactarnos!
Esperamos con interÃ©s poder trabajar contigo y llevar nuestra asociaciÃ³n al siguiente nivel.
Saludos cordiales,

Patricio Juan Perez Perez
Gerente de Marketing 
KeysGamer
marketing@keysgamer.com 
TelÃ©fono: +984356073

- Disclaimer!: Esto NO ES un virus real, solo se asemeja a uno por su dificultad de entendimiento.   
- Hint!: A windows no le gusta visual basic script.

### SoluciÃ³n:
En general hay que des-ofuscar varias veces los archivos .vbs y .ps1 que se descargan de internet.
Puede ser manualmente, pero es muy engorroso, lo mejor es entender quÃ© estÃ¡ pasando, para quedarse 
solo con las variables que almacenan strings para despues imprimirlas en consola.
Primero se des-ofusca un visual basic script, que apunta a la url https://pastebin.pl/view/raw/3b56f95d. este segundo .vbs se des-ofusca para obtener 
un powershell, este se des-ofusca para obtener un segundo powershell, el loader del malware. Para evitar predecir el patrÃ³n del loader hay una funcion 
que aleatoriamente descarga un recurso, que contiene entre banderas BASE64START-BASE64END el payload en base64. En este caso la flag estÃ¡ dividida entre las tres imÃ¡genes,
en orden: https://pastebin.com/raw/gtZXw8iz, https://pastebin.com/raw/dMtBy5B0, https://pastebin.com/raw/BHGR7Vgc.

